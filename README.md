# Tor Portable

Продвинутая утилита для повседневного обхода цензуры (оптимизировалась под Ютуб и Дискорд) и совместного использования с PAC Антизапрет, в основе которой лежит чистое ядро Тора.
Возможно, единственное в мире средство, инициализирующее сразу три метода обхода блокировок (резистентная сеть PAC прокси серверов, VPN и DPI обход по UDP) для одновременного использования.
В наличии exe с тихим запуском, лёгкая установка и удаление службы, новейший (2024 год) протокол противодействия цензуре, полное раздельное туннелирование и многое другое, полностью бесплатно.

Без внимательного чтения инструкции у вас НАСТРОИТЬ НИЧЕГО НЕ ПОЛУЧИТСЯ!

**Read the English instructions below.**

Support us:

5536 9141 8416 7645 — Verity Freedom (портативный Tor)

***https://antizapret.prostovpn.org/donate.html — ValdikSS (прокси Antizapret, ВАЖНО в ноябре и декабре каждого года)***

Разработано при поддержке сообщества (в особенности отмечу помощь от DesuIsALie и bananakid).
Основной автор портативного Тора — Verity Freedom.
Автор прокси Антизапрет — ValdikSS.
Tor Expert Bundle от Tor Project.
SwitchyOmega от FelisCatus, ZeroOmega от zero-top.
Discord-drover от hdrover.

<a href="https://star-history.com/#Verity-Freedom/Tor-Portable&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=Verity-Freedom/Tor-Portable&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=Verity-Freedom/Tor-Portable&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=Verity-Freedom/Tor-Portable&type=Date" />
 </picture>
</a>

## Инструкция

Обратите повышенное внимание, для какой OS и её версии вы ставите программу, ибо ранее несколько человек запутались в этом (слава нашим героям, без их вмешательства в жизни бы не добавил это уточнение). Перейдите по [ссылке на IPNS](https://ipfs.io/ipns/k51qzi5uqu5dldod6robuflgitvj276br0xye3adipm3kc0bh17hfiv1e0hnp4/), скачайте и распакуйте архив, зайдите в полученную вами папку. Тор запускается через AntiTor.exe (или AntiTor.cmd, если исполняемый файл вам не нужен), моментально сворачиваясь, что делает его совместимым с автозагрузкой (win+r shell:startup) и закреплением exe в панель задач. Чтобы убрать окно Тора, но сохранить его работоспособность, вы можете создать/удалить службу через двойной запуск service-manager.cmd; службы сохраняются после выключения ПК.

Тор НЕНАВИДИТ специальные символы по типу скобочек, они могут помешать ему запуститься (например в папке program files (x86)); при этом при запуске в папке с кириллицей проблем не будет. Лог работы содержится по адресу tor\notice.log, также именно он выдаётся вам в командной строке.

AntiTor.exe тригерит большое количество антивирусов из-за особенностей сборки файла, так как у batch не существует нативного, чистого компилятора. Однако без него невозможно закрепить программу в панель задач, не будет иконки. Особенно жёстким может оказаться Windows Defender, в последние годы он стал этим печально известен. Если вы не ожидаете борьбы с собственным антивирусом, скачайте AntiTor_win8+AntiDetect.zip и запустите AntiTor.cmd: в нём нет файла exe, и антивирусы жрать его не будут. Пользователи win 7 могут проигнорировать проблему, ибо антивирус в ней значительно мягче. Проблема будет актуальна до тех пор, пока я не подпишу exe легитимной корпоративной подписью; это стоит много денег.

Tor.exe в папке tor не запускайте, не сработает. Особенно актуально для пользователей AntiDetect версии. Я создал её для того чтобы ваши антивирусы не агрились, а не для того чтобы вы путались, какой именно файл запустить при отсутствии AntiTor.exe. Запускайте AntiTor.cmd. Не качайте файл Source code (zip), его система сформировала автоматически, и в нём содержится только исходный код. Просто перейдите по ссылке и скачайте нужный релиз. Всё? Несложно? Я надеюсь.

Откройте папку discord-drover, запустите файл drover.exe и нажмите install (только на Windows). Это разблокирует клиентское приложение Дискорда вместе с голосовыми чатами без всяких задержек благодаря обходу UDP, пока Тор запущен как программа или служба.

![0](https://github.com/user-attachments/assets/aa520f99-cc6a-45f3-84d5-6da15b587225)

В случае проблем на win 7, вам стоит запустить файл reset-oldwin-patch и попробовать сменить редакцию. Патчи под x86 и x64 разные, у них нет обратной совместимости, и если вы поставили неправильный, сам он не пропадёт. Патч на win 7 ставится бесшовно при первом же запуске. Если у вас более старая винда по типу висты, то пробуйте win 7x86, но я не гарантирую абсолютно ничего и часть функционала может деградировать (например служба использует powershell, который поставляется всем начиная с win 7, установить его можно вручную).

Вам необходимо поставить расширение ZeroOmega ([Chrome](https://chromewebstore.google.com/detail/proxy-switchyomega-3-zero/pfnededegaaopdmhkdmcofjmoldfiped), [Firefox](https://addons.mozilla.org/en-US/firefox/addon/zeroomega/)). Обязательно закрепите его в панель расширений. Перед использованием ZeroOmega на Firefox необходимо предоставить ему разрешение «Запуск в приватных окнах». Я очень советую всем поставить 5 звёзд ZeroOmega в вашем магазине, так как это, буквально, лучшее браузерное расширение планеты по множеству причин. Без него существование Tor Portable бы не было возможным.

Опционально, но рекомендуется поставить лучший, народный адблок — uBlock Origin ([Chrome](https://chromewebstore.google.com/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm), [Firefox](https://addons.mozilla.org/ru/firefox/addon/ublock-origin/)), чтобы вас не беспокоила реклама разблокированного без всяких региональных ограничений Ютуба. Его уважают и разработчики, и простые пользователи, как самый лучший блокировщик рекламы.

Для Омеги вам необходимо синхронизировать все настройки с моими, чтобы не ставить их вручную. Это даст вам и всё необходимое, и красивую тему (нескучные обои!) xcode-dusk. Тема изменится после обновления вкладки. Используйте ссылку https://ipfs.io/ipns/k51qzi5uqu5dldod6robuflgitvj276br0xye3adipm3kc0bh17hfiv1e0hnp4/ZeroOmegaOptions.bak для мгновенной синхронизации, куда именно нужно вставить её показано на изображении. Если вы не вставите её, а кликните по ней, то файл скачается локально, и вы больше не потеряете его; расширение поддерживает как синхронизацию по ссылке, так и синхронизацию через файл, но синхронизация по ссылке предпочтительна, ибо файл периодически обновляется, и стоит проводить её повторно через нажатие кнопки restore.

![1](https://github.com/user-attachments/assets/ba35f792-2e3a-4113-94da-f26a3e9fad26)

Основных режимов три — system, AUTO и TOR. Их вы можете переключать нажатием кнопки мыши по расширению, вам необходимо сделать это после синхронизации (лучше остановиться на AUTO). Для корректной работы режим AUTO использует несколько дополнительных. Помимо режимов расширение взаимодействует с тремя списками заблокированных сайтов, имеющих различные функции: [Антизапретом](https://antizapret.prostovpn.org/), [Антицензорити](https://github.com/anticensority/generated-pac-scripts) и [no-russia-hosts](https://github.com/dartraiden/no-russia-hosts).

System используется для совместимости со сторонними VPN, полностью отключая проксирование. Выглядит как чёрный кружок с белым центром. Режим AUTO — фиолетовый круг с чёрным центром, по умолчанию использует устойчивую сеть PAC прокси-серверов Антизапрет для полного раздельного туннелирования только заблокированных сайтов, задействуя Тор по отношению к редактируемому списку, в котором содержатся сайты, которые заблокировали себя от России самостоятельно — no-russia-hosts. Антизапрет работает только для россиян, так как содержит список сайтов, заблокированных в России. Режим AUTO автоматически переключается с ANTI на TOR (надпись на значке расширения), давая понять, задействован ли Тор в проксировании конкретного сайта.

![2](https://github.com/user-attachments/assets/4029c6f7-c63a-44b9-9594-ea8508708689)

Если вы добавили свои сайты в режим AUTO, и сделали бэкап, вы должны проследить за тем, чтобы конечный файл весил не больше 10 мегабайт: это лимит, при котором он корректно читается. Антицензорити — очень жирный список, весящий более 9 мегабайт и по умолчанию даже не использующийся, в своих файлах синхронизации я оставляю только ссылку на него, уменьшая вес .bak более чем в 10 раз, но у вас он может скачаться в фоне и сломать конфиг.

Режим TOR проксирует весь браузерный трафик, выглядит как фиолетовый круг с белым центром. В TOR возможно измерить скорость подключения, используйте для этого удобный вам сайт, например speedcheck.org. Вашей скорости должно с запасом хватать на 1080 60, на 2К 60.

Для переключения между режимами используется quick switch, опционально вы можете отключить его в любой момент, кликнув правой кнопкой мыши по расширению и нажав Enable Quick Switch. Тогда режимы придётся выбирать вручную в меню, открывающемся левой кнопкой мыши по иконке. Вы можете проявить креативный подход, поменяв тему расширения и цвета режимов. Чтобы восстановить всё как было, проведите повторную синхронизацию.

![3](https://github.com/user-attachments/assets/c055ca4c-d531-4680-ba96-d3fe7bf1c64a)

У ZeroOmega есть очень продвинутый парсер адресов. Его можно использовать чтобы пополнять домёны в режиме AUTO не выходя из расширения, или любых других вещей. Чтобы открыть его, кликните правой кнопкой мыши по расширению и нажмите Network monitor.

![4](https://github.com/user-attachments/assets/a96c04ae-fa78-4c4a-815e-7aac65ffab2c)

Как я написал выше, у расширения есть несколько режимов, но у самого Тора тоже есть режимы работы: pro и default. Смена режима заменяет файл конфигурации torrc.txt. В default выходной ip подбирается случайно, а самим Тором используется 10 мостов одновременно (и скорее всего в любой конкретный момент не все из них работают, что даёт ошибки в консоли). Это значительно минимизирует шанс отказа какой-либо части системы, а у Тора это: мосты, миддлы (они справляются с задачей и работают без перерыва больше года, а потому не рандомятся), и выходы. По своей логике именно этот режим ближе всего к тому, как по умолчанию работает Тор браузер после запроса и получения мостов.

В режиме pro выходной ip задан заранее, по принципу, что он является достаточно быстрым, стабильным и обходит блокировки на Тор. Например, имелось множество случаев, когда в default Дискорд запрещал отправлять изображения, а в pro всё работало корректно. Мостов в режиме pro два, а не десять, ибо фундаментально, больше для работы Тору не требуется. Его минусом является возможность массового отказа для всех тех, у кого этот режим стоял; по сравнению с ним default является практически вечным (может как перестать работать полностью, так и ухудшиться функционал; изображения в Дискорде перестают отправляться, блокировки Ютуба тригерятся).

В случае отказа pro необходимо или переключиться на default, или скачать новые архивы режимов через updater, или перекачать Тор целиком (рекомендуется делать это после обновлений, так как updater в версии 1.7.5 не способен обновить абсолютно все файлы, и в первую очередь нужен для перезаписи режимов). Чтобы сменить режим работы с default на pro или обратно в автоматическом режиме запустите исполняемый файл change-mode.

![5](https://github.com/user-attachments/assets/bc404d5e-f8eb-498d-a894-1aade051eedb)

Отдельной шуткой является тот факт, что помимо блокировок для Тора, для россиян, у Ютуба есть и блокировки на VPN, которые крайне редко, но можно спровоцировать, примером является [это аномальное видео](https://www.youtube.com/watch?v=laTBNUS8Cyo). Вопрос, зачем вообще бороться с блокировкой такой соцсети, которая и так отлично справляется с блокировкой самой себя, пусть останется риторическим.

![image](https://github.com/user-attachments/assets/61b86c3e-d940-4715-afa4-592d7964eca0)

**Далее описанное в целом не влияет на основной функционал Tor Portable, и если вы устали следовать гайду, вам стоит остановиться здесь: Тор готов к работе. Можете писать мне в [Новости и фидбэк](https://github.com/Verity-Freedom/Tor-Portable/issues/8) на любую тему. Удачи.**

----
Второй настройкой для профессионала является Антицензорити — это локальная версия Антизапрета, позволяющая добавить собственные сервера. Основной разблокировщик сайтов в Tor Portable, Антизапрет — скрипт, который в очень сжатом виде хранит огромное количество заблокированных сайтов в России, с защищёнными от цензуры внешними серверами, **которые требуют постоянной оплаты от своего создателя**, ко всем остальным сайтам идёт доступ напрямую. Антизапрет — это невероятное чудо инженерной мысли, одна из старейших прокси-сетей в России (существует с 2013 года), и очень популярная (через Обход блокировок рунета на ней сидит около миллиона человек), но так как зависит от всего одного человека, есть большой шанс, что в какой-то момент она может оказаться недоступна.

Тор же имеет фундаментальный недостаток — так как все его выходы открыты, он много где заблокирован, и при проксировании на весь трафик просто **неюзабелен**. Создатель Антизапрета, ValdikSS, также модифицировал один из самых популярных бесплатных впн своего времени — Psiphon, который до сих пор служит верой и правдой обходя блокировки, и породил его усиленную версию — Psiphon TM, для борьбы с цензурой в Туркменистане. Она медленнее чем оригинал (и я советую вам также [иметь при себе оригинал](https://psiphon.ca/ru/download-store.html), это один из лучших бесплатных VPN, до сих пор сопротивляющийся блокировкам), но лучше защищена от блокировок и совместима с Антицензорити. Также Psiphon не придерживается губительной политики открытых выходов.

Для использования Psiphon TM вам необходимо в настройках AUTO поменять режим проксирования по умолчанию с Антизапрета на Антицензорити, убедиться, что скрипт успешно загружен, скачать [Psiphon TM](https://github.com/Verity-Freedom/Tor-Portable/releases/tag/v1.0) и запустить runme.cmd — он запускается и сразу сворачивается, подобно Тору. Чтобы полностью избавиться от использования Тора в AUTO, необходимо в настройках режима VIRTUAL поменять TOR на PROXY. Войдя в ZeroOmega в режим PROXY с запущенным Psiphon TM, вы распространите его на весь трафик, и сможете прорвать блокировку на такие сайты, которые запрещают Тор, но не попали ни в один список, однако вам придётся зайти в него вручную. Учитывайте, что скорость Psiphon TM существенно ниже комфорта (за комфорт я полагаю 2К 60 без прогрузок). Напоминаю, что оригинальный Psiphon невероятно хорош сам по себе, но с расширением несовместим.

## Разблокировываем ВЕСЬ ИНТЕРНЕТ играючи!

1) Самое простое задание — доступ к даркнету, если вы всё сделали правильно. Перейдите на https://duckduckgogg42xjoc72x3sjasowoarfbgcmvfimaftt6twagswzczad.onion и у вас откроется onion версия поисковика DuckDuckGo. Даркнет теперь будет всегда рядом, но сам DuckDuckGo по даркнету не ищет, если что.
2) Мы разблокировали доступ к статьям о VPN на habr.com — перейдите по https://habr.com/ru/articles/849092/, в ином случае эта статья бы не открылась. Можете перейти в режим system proxy, чтобы подметить разницу, для чего нужно перезагрузить страницу.
3) Пример геозаблокированного видео на Ютуб — https://www.youtube.com/watch?v=-kcOpyM9cBg. Без Тора к нему доступа не будет даже через Запрет, способный разблокировать Ютуб в целом.
4) gosuslugi.ru откроются только в режиме AUTO и system.
5) Доступ на сайт pixiv.net у вас будет только в режиме AUTO. Также только в режиме AUTO прогружаются аватарки на chess.com.
6) Ютуб часто блочит видео только для Тора, хотя, конечно, таких от общей массы немного. Известными видео, которые блокируют Тор, являются: https://www.youtube.com/watch?v=W9lsWI7zhTY, https://www.youtube.com/watch?v=O_ItSLCZWb0, https://www.youtube.com/watch?v=OqPl4QrczTk (данное видео заблокировано и для Тора, и для россиян), вам обязательно нужно изменить режим на change-mode/pro. При этом в режиме pro Тор не будет регенерировать IP, так что в момент, когда он умрёт, ваш Тор просто застынет на 45%, и вам будет необходимо найти нужный IP в: torrc.txt в строке ExitNodesList; самостоятельно; или смириться с блокировками и сменить режим на default.
7) Клиентский Discord запустится только если у вас был установлен drover. В браузере он запустится только в режимах TOR и AUTO без голосовых чатов. Для разблокировки Дискорда в режиме system в браузере вместе с голосовым чатом может понадобиться установка Запрета (в режимах AUTO и TOR войсчат скорее всего не появится). Что гораздо важнее, для разблокировки отправки изображений в клиенте Дискорда вероятно потребуется смена режима через change-mode/pro.
8) <rawtext>*</rawtext> Начинаются задания повышенной сложности. Попробуйте проиграть данное видео https://www.youtube.com/watch?v=LXb3EKWsInQ в 4К без единой прогрузки. Вероятно, чтобы выполнить это задание, вам потребуется использовать качественный IP из change-mode/pro, однако вам может не хватить даже его, ибо в change-mode/pro используется ip, обходящий блокировки Ютуба на Тор, а не самый быстрый из возможных. Вам стоит измерить скорость на любом удобном чекере и убедиться, что в среднем она превышает 30 mb/s, чтобы заранее понять, есть ли у вас шансы, будь то режим pro или по умолчанию. Чтобы целенаправленно смотреть Ютуб в 4К, можно поменять режим на pro, а затем поменять выход на 0406DF11FC1C04CAF8B771CA2B9BA7C473E9DE4E в torrc.txt вручную, что, конечно, спровоцирует другие специфические ограничения на Тор у Ютуба. Стандартного change-mode/pro может хватить, но успех не гарантирован.
9) <rawtext>*</rawtext> Последнее задание — доступ к grok.com. Grok.com заблокирован как для россиян, так и для абсолютно всех ip Тора. Чтобы прорвать блокировку к нему, нужно скачать [Psiphon TM](https://github.com/Verity-Freedom/Tor-Portable/releases/tag/v1.0), отключить quick switch и вручную сменить режим на PROXY с запущенным Psiphon TM. Если вы встречаетесь с заблокированным сайтом, в который не получается попасть ни через один из стандартных режимов расширения, этот алгоритм действий поможет в большинстве случаев.

После выполнения всех заданий вы можете знать, что овладели Tor Portable в совершенстве.

На некоторых сайтах по типу polymarket.com могут быть сложности с регистрацией даже в режимах TOR и PROXY, так как у него много защит, а у Тора очень грязные ip. Важно знать, что даже Тор не всесилен, хотя обеспечивает свободный доступ к 99% интернета. Это очередное напоминание, какую ошибку совершили разработчики, открыв все торовские адреса для публичного доступа.

Для проксирования отдельных приложений Тором некоторые используют инструменты по типу [proxifyre](https://github.com/wiresock/proxifyre).

## English instructions

Run the program via AntiTor.exe, let it work in the background. Preferably put a label leading to AntiTor.exe to startup (startup is called by the shell:startup command in the win+r menu), it also can be pinned to the taskbar.
To proxy browser traffic through Tor use ZeroOmega extension, read more about it in readme-visual. Previously, an older SwitchyOmega extension was used, but it's obsolete now. SwitchyOmega recommended only for old browsers.
Switch between ZeroOmega modes using the mouse button: TOR (everything is proxified by only one proxy), AUTO (only some sites are proxified), system (nothing is proxified, you can use a third-party VPN). PAC Antizapret only for Russians.
We are using Drover to proxify Discord through Tor and bypass UDP block.

Bridges use four completely different connection types: obfs4, snowflake, conjure and webtunnel (default, it is optimal to use only it because of the greater stability).
Replace the bridges by editing the torrc file, receive new ones via a bridge request in the tor browser or send an empty email to bridges@torproject.org.
The new webtunnel bridge can be obtained at https://bridges.torproject.org/bridges/?transport=webtunnel and https://github.com/scriptzteam/Tor-Bridges-Collector/blob/main/bridges-webtunnel, there is also a large list of webtunnel bridges inside.
Bridges may disappear gradually, as the program informs you that one of the bridges has failed, which negatively affects the quality of the connection and can lead to its complete breakdown.
I recommend reading torrc.txt, because in addition to the code for the correct operation of the program, it contains many important technical details and even has settings to increase speed (language English).

Use the service-manager file if you want to install or uninstall Tor as service.

Ready!
